---
description: |
  反復レビュープロセス
  「/review-loop [対象]」で開始
  指摘がなくなるまでレビュー→修正を繰り返し
argument-hint: [target: code|design|security|all]
---

# レビューループ: $1

## 概要
$1 に対する反復レビューを開始します。
全ての指摘が解決されるまで、レビュー→修正のサイクルを繰り返します。

---

## レビュー設定

### 対象選択
- `code`: コードスタイル、品質
- `design`: 設計、アーキテクチャ
- `security`: セキュリティ
- `all`: 全観点

### 使用スキル
| 対象 | 参照スキル |
|------|-----------|
| code | coding-style, architecture |
| design | architecture, domain-model |
| security | security-standards |
| all | 全スキル |

---

## レビューサイクル

### Round N

#### Step 1: レビュー実行
code-reviewer エージェントがレビューを実施

#### Step 2: 指摘一覧
```markdown
| ID | 重要度 | ファイル | 指摘内容 | ステータス |
|----|--------|----------|----------|------------|
| 1 | CRITICAL | src/a.ts:42 | [内容] | OPEN |
| 2 | WARNING | src/b.ts:15 | [内容] | OPEN |
| 3 | INFO | src/c.ts:30 | [内容] | OPEN |
```

#### Step 3: 判定
```
指摘あり?
    │
    ├── CRITICAL あり → 必須修正 → Step 4
    │
    ├── WARNING のみ → 修正推奨 → Step 4
    │
    ├── INFO のみ → 任意対応可 → 完了も可
    │
    └── 指摘なし → ✅ 完了
```

#### Step 4: 修正
implementer エージェントが指摘を修正
- CRITICAL: 全て修正必須
- WARNING: 修正推奨
- INFO: 任意

#### Step 5: 再レビュー
修正完了後、Round N+1 へ

---

## 収束条件

以下の条件を全て満たした時に完了：

- [ ] CRITICAL 指摘: 0件
- [ ] WARNING 指摘: 0件
- [ ] 新規指摘なし
- [ ] レビュアー承認

---

## 指摘追跡

### 指摘ステータス
| ステータス | 説明 |
|------------|------|
| OPEN | 未対応 |
| IN_PROGRESS | 対応中 |
| RESOLVED | 修正済み（未確認） |
| VERIFIED | 修正確認済み |
| WONT_FIX | 対応しない（理由あり） |

### 指摘履歴
```markdown
## Round 1
- 新規指摘: 5件
- 解決: 0件
- 残り: 5件

## Round 2
- 新規指摘: 1件
- 解決: 4件
- 残り: 2件

## Round 3
- 新規指摘: 0件
- 解決: 2件
- 残り: 0件 ✅
```

---

## 出力形式

### レビュー結果（各ラウンド）
```markdown
## Round N レビュー結果

### ステータス: [NEEDS_WORK / APPROVED]

### 指摘サマリー
| 重要度 | 新規 | 解決 | 残り |
|--------|------|------|------|
| CRITICAL | 0 | 0 | 0 |
| WARNING | 1 | 2 | 1 |
| INFO | 0 | 1 | 0 |

### 新規指摘
[今回のラウンドで発見された指摘]

### 解決済み
[修正が確認された指摘]

### 次のアクション
1. [対応すべき項目]
```

### 最終結果
```markdown
## レビュー完了

### 最終ステータス: APPROVED ✅

### サマリー
- 総ラウンド数: 3
- 総指摘数: 6
- 解決済み: 6 (100%)

### 品質評価
- コードスタイル: ✅
- セキュリティ: ✅
- 設計: ✅
```

---

## 注意事項

- 無限ループを防ぐため、5ラウンドを超えたら中断を検討
- INFO レベルは任意対応（完了をブロックしない）
- WONT_FIX には明確な理由が必要
