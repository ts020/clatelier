# スキル体系の設計思想

なぜこのようなスキル・エージェント・コマンド体系を設計したのかを説明します。

## 背景

### 解決したかった課題

1. **スキルが発火しない問題**
   - descriptionが曖昧だと自動発火しない
   - トリガーワードの設計が重要

2. **知識とメタ情報の混在**
   - SKILL.mdに全てを詰め込むと保守が困難
   - ドキュメントの再利用ができない

3. **開発プロセスの標準化**
   - 属人化を防ぎたい
   - 品質を一定に保ちたい

## 設計の原則

### 1. 関心の分離

```
知識（何を・なぜ）  ←  docs/
        ↓
スキル（いつ使うか） ←  skills/
        ↓
エージェント（誰が） ←  agents/
        ↓
コマンド（どうやって）←  commands/
```

**理由**: 変更の影響範囲を限定し、保守性を向上させる。

### 2. 明示的なトリガー

スキルの `description` には具体的なトリガーワードを含める：

```yaml
description: |
  「実装して」「コードを書いて」時に参照。
```

**理由**: 自動発火の確率を上げ、予測可能な動作を実現する。

### 3. 専門化されたエージェント

各エージェントは1つの専門領域に特化：

| エージェント | 専門領域 |
|-------------|---------|
| architect | 設計 |
| implementer | 実装 |
| code-reviewer | レビュー |
| qa-specialist | テスト |
| debugger | デバッグ |

**理由**: 責務を明確にし、適切な権限設定を可能にする。

### 4. 反復型プロセス

レビューは収束するまで繰り返す：

```
実装 → レビュー → 指摘あり? → 修正 → レビュー → ...
                    ↓
                指摘なし → 完了
```

**理由**: 品質基準を確実に満たすため。

## 知識の階層

### Diataxis準拠のドキュメント構造

```
docs/
├── tutorials/     # 学習体験（初心者向け）
├── how-to/        # 問題解決（経験者向け）
├── reference/     # 事実（全員向け）
└── explanation/   # 背景（深掘り向け）
```

**なぜDiataxisか？**
- 読者の目的に合わせた構造
- 混在を防ぐことで各ドキュメントの品質向上
- 業界標準として広く採用されている

### スキルが参照するドキュメント

| スキルタイプ | 主な参照先 |
|-------------|-----------|
| ドメイン知識 | reference/domain/ |
| 技術規約 | reference/technical/ |
| 品質基準 | reference/quality/ |
| 設計思想 | explanation/ |

## エージェント間の連携

### 委譲パターン

```
[architect] 設計完了
    ↓ 設計書を渡す
[implementer] 実装
    ↓ コードを渡す
[code-reviewer] レビュー
    ↓ 指摘を渡す
[implementer] 修正
    ↓ 修正コードを渡す
[code-reviewer] 再レビュー
```

### 参照パターン

各エージェントは必要なスキルを参照：

```
[implementer]
    ├── coding-style スキル → docs/reference/technical/coding-style.md
    ├── domain-model スキル → docs/reference/domain/glossary.md
    └── security スキル → docs/reference/quality/security.md
```

## 拡張性

### 新しいスキルの追加

1. `docs/` に知識を追加
2. `.claude/skills/` にメタ情報を追加
3. 必要に応じてエージェントから参照

### 新しいエージェントの追加

1. `.claude/agents/` に定義を追加
2. 必要なスキルへの参照を設定
3. 必要なツール権限を設定

### 新しいコマンドの追加

1. `.claude/commands/` に定義を追加
2. 必要なエージェントの呼び出しを記述
3. フェーズと完了条件を明記

## 今後の展望

- **MCPサーバー統合**: 外部サービスとの連携
- **プラグイン化**: 組織共有のスキルパッケージ
- **自動化強化**: フックによる品質ゲート
